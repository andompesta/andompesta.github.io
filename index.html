<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Sandro Cavallari</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-d3a9a206728f765718155175211757d5.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/academicons-1.9.2/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/academicons-1.9.2/size.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Sandro Cavallari</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./posts"> 
<span class="menu-text">Posts</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<div class="quarto-about-solana column-body">
  <div class="about-entity">
    <div class="entity-contents">
      <header id="title-block-header" class="quarto-title-block"></header> <div class="about-links">
  <a href="https://www.linkedin.com/in/sandro-cavallari-58961b72/" class="about-link" rel="" target="">
    <i class="bi bi-linkedin"></i>
     <span class="about-link-text">LinkedIn</span>
  </a>
  <a href="https://twitter.com/Andompesta90" class="about-link" rel="" target="">
    <i class="bi bi-twitter"></i>
     <span class="about-link-text">Twitter</span>
  </a>
  <a href="https://github.com/andompesta" class="about-link" rel="" target="">
    <i class="bi bi-github"></i>
     <span class="about-link-text">Github</span>
  </a>
  <a href="mailto:ando.cavallari@gmail.com" class="about-link" rel="" target="">
     <span class="about-link-text"><i class="fa-solid fa-envelope" aria-label="envelope"></i> Email</span>
  </a>
  <a href="https://scholar.google.com/citations?user=5MYDlisAAAAJ&amp;hl=it&amp;oi=ao" class="about-link" rel="" target="">
     <span class="about-link-text"><i class="ai  ai-google-scholar"></i> Google Scholar</span>
  </a>
</div>
      <div class="about-contents"><main class="content" id="quarto-document-content">
<section id="welcome" class="level1">
<h1>Welcome</h1>
<p>This is my personal space where I keep all my notes from my ML experience. I’m mostly interested in NLP and graph embeddings/analytics. Thus expect most of the material to cover:</p>
<ul>
<li>Fundamentals of Deep Learning;</li>
<li>Fundamentals of Reinforcement Learning;</li>
<li>Basic Stats;</li>
<li>Basic of Neural ODE.</li>
</ul>
<p>Please note that this website is ment to keep only my personal material, this it my contains errors and typos.</p>
<hr>
<p>Here are some working principles I try to apply during my working expeience.</p>
<section id="my-vision-of-skunkworks-rules" class="level2">
<h2 data-anchor-id="my-vision-of-skunkworks-rules">My vision of Skunkworks Rules</h2>
<ol type="1">
<li>The Skunk Works workers must be delegated practically complete control of his program in all aspects.</li>
<li>The number of people having any connection with the project must be restricted in an almost vicious manner. Use a small number of good people (10% to 25% compared to the so-called normal systems).</li>
<li>A very simple drawing and drawing release system with great flexibility for making changes must be provided.</li>
<li>There must be a minimum number of reports required, but important work must be recorded thoroughly.</li>
<li>Access by outsiders to the project and its personnel must be strictly controlled by appropriate security measures.</li>
<li>Because only a few people will be used in engineering and most other areas, ways must be provided to reward good performance by pay not based on the number of personnel supervised.</li>
</ol>
</section>
<section id="musks-development-principles" class="level2">
<h2 data-anchor-id="musks-development-principles">Musk’s Development Principles</h2>
<ol type="1">
<li><p><strong>Make the requirements less dumb</strong>. “Your requirements are definitely dumb, it does not matter who gave them to you.” Uses this step to test assumptions and question-the-question, especialy if it come from a ‘smart person’ since you might not question them enough.</p></li>
<li><p><strong>Delete the part or process.</strong> “If you’re not adding things back in at least 10% of the time, you’re clearly not deleting enough.” Starting lean and building up when and if required, but be strongly bias throward removing thinks. Each requirement or constraint must be accountable to a person, so you can ask that person about its relevance and purpose.</p></li>
<li><p><strong>Simplify or optimise the design.</strong> “Possibly the most common error of a smart engineer is to optimise a thing that should not exist”. Do your work and go through the first two steps before trying to optimise. To do this effectively you need an holistic view of the project and you need to consider the overall cost-benefit for a more complicated design.</p></li>
<li><p><strong>Accelerate cycle time.</strong> “Try a bunch of things, and do more of what works”. Once you have find the right direction is time to accelerate the lifecycle. Aim for an experiment a day. Note that, it is extreamly importanto to do the first 3 steps before as “if you’re digging your grave, don’t dig faster.”</p></li>
</ol>
<hr>
</section>
</section>
<section id="not-to-do" class="level1">
<h1>Not To Do</h1>
<p>In 1944, the CIA wrote a handbook on how to sabotage (enemy) organizations from the inside. A few interesting tips:</p>
<ol type="1">
<li>Insist on doing everything through “channels.” Never permit short-cuts to be taken in order to expedite decisions.</li>
<li>Make “speeches.” Talk as frequently as possible and at great length.</li>
<li>When possible, refer all matters to committees, for “further study and consideration.” Attempt to make the committees as large as possible—never less than five.</li>
<li>Bring up irrelevant issues as frequently as possible.</li>
<li>Haggle over precise wordings of communications, minutes, resolutions.</li>
<li>Refer back to matters decided upon at the last meeting and attempt to re-open the question of the advisability of that decision.</li>
<li>Demand written orders.</li>
<li>“Misunderstand” orders. Ask endless questions or engage in long correspondence about such orders. Quibble over them when you can.</li>
<li>Do everything possible to delay the delivery of orders. Even though parts of an order may be ready beforehand, don’t deliver it until it is completely ready.</li>
<li>In making work assignments, always sign out the unimportant jobs first.</li>
<li>Insist on perfect work in relatively unimportant products; send back for refinishing those which have the least flaw. Approve other defective parts whose flaws are not visible to the naked eye.</li>
<li>When training new workers, give incomplete or misleading instructions.</li>
<li>To lower morale and with it, production, be pleasant to inefficient workers; give them undeserved promotions. Discriminate against efficient workers; complain unjustly about their work.</li>
<li>Hold conferences when there is more critical work to be done.</li>
<li>Multiply paper work in plausible ways.</li>
<li>Start duplicate files.</li>
<li>Multiply the procedures and clearances involved in issuing instructions, pay checks, and so on. See that three people have to approve everything where one would do.</li>
<li>Apply all regulations to the last letter.</li>
<li>Do your work poorly and blame it on bad tools, machinery, or equipment. Complain that these things are preventing you from doing your job right.</li>
<li>Never pass on your skill and experience to a new or less skillful worker.</li>
<li>Snarl up administration in every possible way. Fill out forms illegibly so that they will have to be done over; make mistakes or omit requested information in forms.</li>
<li>Give lengthy and incomprehensible explanations when questioned.</li>
<li>Act stupid.</li>
<li>Be as irritable and quarrelsome as possible without getting yourself into trouble.</li>
<li>Misunderstand all sorts of regulations concerning such matters as rationing, transportation, traffic regulations.</li>
</ol>
<div id="fig-fbi-handbook" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fbi-handbook-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/img/handbook.jpeg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fbi-handbook-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Credit to <a href="https://www.linkedin.com/feed/update/urn:li:activity:7018144158573854721/">Roel Staes linkedIn post</a>.
</figcaption>
</figure>
</div>
<hr>
<p><a href="https://nat.org/">Nat Friedman</a> has been the CEO of github from 2018 to 2021. On his website there are some interesting wisdows pils I want to record.</p>
<section id="from-nats-website" class="level2">
<h2 data-anchor-id="from-nats-website">From Nat’s website</h2>
<ol type="1">
<li>As human beings it is our right (maybe our moral duty) to reshape the universe to our preferences
<ul>
<li>Technology, which is really knowledge, enables this</li>
<li>You should probably work on raising the ceiling, not the floor</li>
</ul></li>
<li>Enthusiasm matters!
<ul>
<li>It’s much easier to work on things that are exciting to you</li>
<li>It might be easier to do big things than small things for this reason</li>
<li>Energy is a necessary input for progress</li>
</ul></li>
<li>It’s important to do things fast
<ul>
<li>You learn more per unit time because you make contact with reality more frequently</li>
<li>Going fast makes you focus on what’s important; there’s no time for bullshit</li>
<li>“Slow is fake”</li>
<li>A week is 2% of the year</li>
<li>Time is the denominator</li>
</ul></li>
<li>The Efficient Market Hypothesis (EMH) is a lie
<ul>
<li>At best it is a very lossy heuristic</li>
<li>The best things in life occur where EMH is wrong</li>
<li>In many cases it’s more accurate to model the world as 500 people than 8 billion</li>
<li>“Most people are other people”</li>
</ul></li>
<li>We know less than we think
<ul>
<li>The replication crisis is not an aberration</li>
<li>Many of the things we believe are wrong</li>
<li>We are often not even asking the right questions</li>
</ul></li>
<li>The cultural prohibition on micromanagement is harmful
<ul>
<li>Great individuals should be fully empowered to exercise their judgment</li>
<li>The goal is not to avoid mistakes; the goal is to achieve uncorrelated levels of excellence in some dimension</li>
<li>The downsides are worth it</li>
</ul></li>
<li>Smaller teams are better
<ul>
<li>Faster decisions, fewer meetings, more fun</li>
<li>No need to chop up work for political reasons</li>
<li>No room for mediocre people (can pay more, too!)</li>
<li>Large-scale engineering projects are more soluble in IQ than they appear</li>
<li>Many tech companies are 2-10x overstaffed</li>
</ul></li>
<li>Where do you get your dopamine?
<ul>
<li>The answer is predictive of your behavior</li>
<li>Better to get your dopamine from improving your ideas than from having them validated</li>
<li>It’s ok to get yours from “making things happen”</li>
</ul></li>
<li>You can do more than you think
<ul>
<li>We are tied down by invisible orthodoxy</li>
<li>The laws of physics are the only limit</li>
</ul></li>
</ol>
<hr>
</section>
</section>
<section id="razors-rules" class="level1">
<h1>Razor’s Rules</h1>
<p>Everyone is falimialr with the infamous <a href="https://en.wikipedia.org/wiki/Occam%27s_razor">Occam’s razor</a> rule. However, recelty I stuped uppon a <a href="https://twitter.com/george__mack">George Mack</a> tweet listing a bunch of other useful rules:</p>
<ol type="1">
<li><p><strong>Bragging Razor</strong>: If someone brags about their success or happiness, assume it’s half what they claim. If someone downplays their success or happiness, assume it’s double what they claim</p></li>
<li><p><strong>High Agency Razor</strong>: If unsure who to work with, pick the person that has the best chances of breaking you out of a 3rd world prison.</p></li>
<li><p><strong>The Early-Late Razor</strong>: If it’s a talking point on Reddit, you might be early. If it’s a talking point on LinkedIn, you’re definitely late.</p></li>
<li><p><strong>Luck Razor</strong>: If stuck with 2 equal options, pick the one that feels like it will produce the most luck later down the line. I used this razor to go for drinks with a stranger rather than watch Netflix. In hindsight, it was the highest ROI decision I’ve ever made.</p></li>
<li><p><strong>Buffett’s Law</strong>; “The value of every business is 100% subject to government interest rates” - Warren Buffett</p></li>
<li><p><strong>The 6-Figure Razor</strong>: If someone brags about “6 figures” – assume it’s closer to $100K than $900K.</p></li>
<li><p><strong>Parent Rule</strong>: Break down the investments your parents made in you: Time, Love, Energy, and Money. If they are still alive, aim to hit a positive ROI (or at least break even.)</p></li>
<li><p><strong>Instagram Razor</strong>: When you see a photo of an influencer looking attractive on Instagram – assume there are 99 worse variations of that photo you haven’t seen.They just picked the best one.</p></li>
<li><p><strong>Narcissism Razor</strong>: If worried about people’s opinions, remember they are too busy worrying about other people’s opinions of them. 99% of the time you’re an extra in someone else’s movie</p></li>
<li><p><strong>Everyday Razor</strong>: If you go from doing a task weekly to daily, you achieve 7 years of output in 1 year. If you apply a 1% compound interest each time, you achieve 54 years of output in 1 year.</p></li>
<li><p><strong>Bezos Razor</strong>: If unsure what action to pick, let your 90-year-old self on death bed choose it.</p></li>
<li><p><strong>Creativity Razor</strong>: If struggling to think creatively about a subject, transform it:</p>
<ul>
<li>Turn a thought into a written idea;</li>
<li>A written idea into a drawing;</li>
<li>A drawing into an equation;</li>
<li>An equation into a conversation.<br>
In the process of transforming it, you begin to spot new creative connections.</li>
</ul></li>
<li><p><strong>The Roman Empire Rule</strong>: Historians now recognize the Roman Empire fell in 476 – but it wasn’t acknowledged by Roman society until many generations later. If you wait for the media to inform you, you’ll either be wrong or too late.</p></li>
<li><p><strong>Physics Razor</strong>: If it doesn’t deny the law of physics, then assume it’s possible. Do not confuse society’s current lack of knowledge – with this knowledge being impossible to attain. E.g., the smartphone seems impossible to someone from the 1800s – but it was possible, they just had a lack of knowledge.</p></li>
<li><p><strong>Skinner’s Law</strong>: If procrastinating, you have 2 ways to solve it:</p>
<ul>
<li>Make the pain of inaction &gt; Pain of action;</li>
<li>Make the pleasure of action &gt; Pleasure of inaction.</li>
</ul></li>
<li><p><strong>Network Razor</strong>: If you have 2 quality people that would benefit from an intro to one another, always do it. Networks don’t divide as you share them, they multiply.</p></li>
<li><p><strong>Gell-Mann Razor</strong>: Assume every media article contains a % of false information. Sandbox the article from your worldview until you’ve: 1) Seen primary sources; 2) Spoken to 3 domain experts.</p></li>
<li><p><strong>Taleb’s Surgeon</strong>: If presented with two equal candidates for a role, pick the one with the least amount of charisma. The uncharismatic one has got there despite their lack of charisma. The charismatic one has got there with the aid of their charisma.</p></li>
</ol>


</section>
</main></div>
    </div>
    <img src="assets/img/IMG_1695.JPG" class="about-image
  rounded " style="width: 15em;">
  </div>
</div>
 <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/andompesta\.github\.io\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>